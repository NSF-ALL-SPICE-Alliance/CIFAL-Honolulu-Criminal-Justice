---
title: "Spider_Chart_OC_index"
output: html_document
date: "2023-02-04"
---

#installing packages
```{r}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(here)
library(janitor)
library(fmsb)
library(RColorBrewer)
```

```{r}
global_oc_index_spider <- read_csv(here("data/global_oc_index_2021_sids_category.csv"))
```


```{r}
data <- as.data.frame(matrix( sample( 2:20 , 10 , replace=T) , ncol=10))
colnames(data) <- c("criminality" , "english" , "biology" , "music" , "R-coding", "data-viz" , "french" , "physic", "statistic", "sport" )
```


```{r}
# To use the fmsb package, I have to add 2 lines to the dataframe: the max and min of each topic to show on the plot!
data <- rbind(rep(20,10) , rep(0,10) , data)
```


```{r}
# The default radar chart 
radarchart(data)
```

```{r}
global_oc_index_spider <- global_oc_index_spider %>% 
  clean_names() 



global_oc_index_spider <- global_oc_index_spider %>%
  mutate(overall_score = resilience - criminality)
```


```{r}
global_oc_index_spider_sids <- global_oc_index_spider %>% 
  filter(sids_category == "sids")
  
```


```{r}
sids_overall_score_plot <- ggplot(data = global_oc_index_spider_sids, aes(x = overall_score,
                                                                          y = reorder(country, overall_score),
                                                                          fill = region)) +
  geom_bar(stat = "identity") +
  scale_fill_brewer(palette = "Paired")

sids_overall_score_plot
```


```{r}
global_oc_index_spider_sids_criminality <- global_oc_index_spider_sids %>% 
  select(country, criminality)
```


```{r}
global_oc_index_spider_sids_criminality_wider <- global_oc_index_spider_sids_criminality %>% 
  pivot_wider(names_from = country,
              values_from = criminality)
```

```{r}
radar_data <- rbind(rep(8,4) , rep(0,8) , global_oc_index_spider_sids_criminality_wider)
```


```{r}
radarchart(radar_data, pfcol = "steelblue")
```


---
title: "Vulnerability Index - Organized Crime"
author: "Andrew Nishitomi & Connor Flynn"
date: "2/1/2023"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(here)
library(janitor)
```

```{r}
oc_index <- read_csv(here("data/global_oc_index_2021_sids_category.csv"))
```

```{r}
oc_index <- oc_index %>% 
  clean_names()
```


```{r}
oc_index_overall_score <- oc_index %>% 
  mutate(criminality_mean_score = rowMeans(across(c(criminality, criminal_markets, human_trafficking, human_smuggling, 
                                                  arms_trafficking, flora_crimes, fauna_crimes, non_renewable_resource_crimes,
                                                  heroin_trade, cocaine_trade, cannabis_trade, synthetic_drug_trade, criminal_actors,
                                                  mafia_style_groups, criminal_networks, state_embedded_actors, foreign_actors))))
```


```{r}
oc_index_overall_score <- oc_index_overall_score %>% 
  mutate(resillience_mean_score = rowMeans(across(c(political_leadership_and_governance, government_transparency_and_accountability,international_cooperation, national_policies_and_laws, judicial_system_and_detention, law_enforcement, territorial_integrity, anti_money_laundering, economic_regulatory_capacity, victim_and_witness_support, prevention, non_state_actors))))
```


```{r}
oc_index_overall_score <- oc_index_overall_score %>% 
  mutate(overall_score = resillience_mean_score - criminality_mean_score)
```



Histogram

```{r}
oc_index_longer <- oc_index %>% 
  pivot_longer(cols = criminality:non_state_actors, 
               names_to = "ranking", 
               values_to = "value")
```


```{r}
ggplot(data = oc_index_longer, aes(x = value)) +
  geom_histogram() +
  theme_minimal() +
  facet_grid(~sids_category)
```

```{r}
ggplot(data = oc_index_longer, aes(x = value, fill = sids_category)) +
  geom_histogram() +
  theme_minimal() +
  facet_wrap(~region)
```



Optional - Make a new column in oc_index_longer that indicates whether a ranking is a criminality score (low is good?) or a resillience score (high is good)
